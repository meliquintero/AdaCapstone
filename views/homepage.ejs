<!-- Default home page -->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600' rel='stylesheet' type='text/css'>

  <form method="post" action="/destinations" class = "form-inline">
    <div class="form-group">
      <label for="origin_one">Origin</label>
      <input type="text" name="origin_one" class="form-control air" id="term" placeholder="City name or airport code" />
    </div>

    <div class="form-group">
      <label for="origin_two">Origin</label>
      <input type="text" name="origin_two" class="form-control air" id="term" placeholder="City name or airport code" />
    </div>

    <div class="form-group">
      <label for="departure_date">Departure Date</label>
      <input type="date" name="departure_date" class="form-control"/>
    </div>

    <div class="form-group">
      <label for="return_date">Return Date</label>
      <input type="date" name="return_date" class="form-control"/>
    </div>

    <button type="submit" class="btn btn-default">Find Destinations</button>
  </form>


<script>
    $(function() {
        $('.air').click(function (e) {
            e.preventDefault();
            initAutoSelect(e);
        });
        function initAutoSelect(e) {
          console.log(e.target);
            apca = new apc('multi', { key: "a9a241f286",limit: 7 });
            var autocompleteObj = {
                source: function( request, response ) {
                    // make the request
                    console.log($(e.target).val());
                    apca.request( $(e.target).val() );

                    apca.onSuccess = function (data) {
                        if (data.status) { // success
                            response( $.map( data.airports, function( item ) {
                                return {
                                    label: item.name + ' (' + item.iata + ')',
                                    value: item.iata,
                                    code: item.iata
                                }
                            }));
                        } else { // no results
                            response();
                        }
                    };
                    apca.onError = function (data) {
                        response();
                        console.log(data.message);
                    };
                },
                select: function( event, ui ) {
                    // do something for click event
                    console.log(ui.item.code);
                }
            }
            $( ".air" ).autocomplete(autocompleteObj);
        }
    });
</script>
